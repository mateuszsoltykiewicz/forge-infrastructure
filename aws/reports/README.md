# Reports Directory

This directory contains execution reports from security group automation tools.

## Files

- `security-group-chainer.yaml` - Latest execution report from security group chainer
  - **Generated by**: `module.security_group_chainer`
  - **Updated on**: Every `terraform apply`
  - **Contains**: Chain status, rules created, errors, timestamps

## Report Format

### Success Example

```yaml
timestamp: "2026-01-13T10:30:00Z"
status: "completed"
execution_time_seconds: 45
chains:
  - name: "alb-to-eks-nodes"
    status: "success"
    master_tier: "ALB"
    slave_tier: "EKSNodes"
    master_sg: "sg-0abcdef1234567890"
    slave_sg: "sg-0fedcba9876543210"
    rules_created: 2
    ports: [80, 443]
    protocol: "tcp"
    bidirectional: false
    
  - name: "eks-cluster-nodes"
    status: "success"
    master_tier: "EKSCluster"
    slave_tier: "EKSNodes"
    master_sg: "sg-0123456789abcdef0"
    slave_sg: "sg-0fedcba9876543210"
    rules_created: 4
    ports: [443, 10250]
    protocol: "tcp"
    bidirectional: true

errors: []
```

### Failure Example

```yaml
timestamp: "2026-01-13T10:30:00Z"
status: "failed"
execution_time_seconds: 120
chains:
  - name: "alb-to-eks-nodes"
    status: "success"
    rules_created: 2
    
  - name: "eks-to-rds"
    status: "failed"
    error: "Security group not found for tier: RDS"
    
errors:
  - chain: "eks-to-rds"
    error: "Security group not found for tier: RDS"
    timestamp: "2026-01-13T10:31:30Z"
```

## Version Control

Reports are **ignored** in version control (configured in `.gitignore`).

To track a specific report in git:
```bash
git add -f reports/security-group-chainer.yaml
git commit -m "Add security group chainer report for reference"
```

## Troubleshooting

### Report Not Generated

**Check:**
1. Module enabled: `enabled = true` in Terraform
2. Docker installed: `docker --version`
3. AWS credentials: `aws sts get-caller-identity`
4. Terraform output for errors

### Report Shows Failures

**Common issues:**
- Security groups don't have correct `Tier` tags
- Security groups don't exist yet
- AWS API rate limiting
- Incorrect configuration in SSM

**Solution:**
```bash
# Check security groups have Tier tags
aws ec2 describe-security-groups \
  --filters Name=tag:Tier,Values=ALB \
  --query 'SecurityGroups[*].[GroupId,GroupName,Tags]'

# Review chains configuration
cat config/chains.yaml

# Check SSM parameter
aws ssm get-parameter \
  --name /forge/security-group-chains \
  --query 'Parameter.Value' \
  --output text
```

## Related Documentation

- [Security Group Automation Guide](../docs/SECURITY_GROUP_AUTOMATION.md)
- [Security Group Chainer Module](../security/security-group-chainer/README.md)
- [YAML-SSM Sync Module](../security/yaml-sync-with-ssm/README.md)
